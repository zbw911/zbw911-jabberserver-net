1. XmppStreamWriter - переписать на очередях, т.к. при медленном соединении будут проблемы.
2. Закрытие соединения синхронное, а отправка асинхронная - могут быть проблемы.